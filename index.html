<!DOCTYPE html>
<html>
  <head>
    <title>service blueprint</title>
    <script type="text/javascript" src="pablo.min.js"></script>
    <script type="text/javascript" src="templates.js"></script>
    <script type="text/javascript" src="d3.min.js"></script>
		<style>
			.row {
				border: 1px solid #CCCCCC;;
			}
			.actor-label {
				position: absolute;
				padding-left: 100px;
				padding-top: 30px;
				text-transform: uppercase;
				color: #666666;
				font-family: 'Helvetica Neue' Arial sans-serif;
				font-size: 80%;
			}
		</style>
  </head>
  <body>
    <div id="paper" style="background-color: #ffa; width: 1000px; height: 600px;"></div>
		<div id="tmp" style="background-color: #faa;width: 1000px; height: 200px;"></div>
		<script type="text/javascript">
			var timeline = {
				0: {'child': '1st trimester'},
				94: {'child': '2nd trimester'},
				188: {'child': '3rd trimester'},
				280: {'mother': 'pregnancy'},
				281: {
					'mother': 'labour and birth',
					'child': 'birth'},
				645: {'child': 'infancy'},
				1000: {'mother': 'postpartum/breastfeeding'},
		 	}

			/* TODO introspect these from templates.js? */
			var actorNames = [
				'mother',
				'child',
				'chw',
				'clinic',
				'district',
				'country',
			];
           
			/* create divs for rows */
			d3.select('#paper').selectAll("div")
			  .data(actorNames)
				.enter().append("div")
				.attr('class', function(d) { return d + "-row row"; })
				.html(function(d,i) { return "<span class='actor-label'>" + d + "</span>" ;});

			/* add svg elements and icons to divs */
			var rows = Pablo('.row').each(function(d, i){
					var row = Pablo(d).root({class: actorNames[i] + '-icon icon', width: 1000, height: 94});
					var icon = Pablo[actorNames[i]]({x: 5, y: 10}).appendTo(row);
					/* grab fill color */
					var color = icon.attr('fill');
					if (color === null){
					  / no fill color? probably a group of paths, so check the first child */
					  color = icon[0].childNodes[0].attributes['fill'].nodeValue;
					};
					/* set color of row (so its easy to access later) */
					row[0].parentNode.style.color = color;
					/* set display color of label text */
					row[0].previousSibling.style.color = color;
			});
			var tmp = Pablo('#tmp').root();
			Pablo.chevron({shape: 'narrow', fill: '#EAF4E7'}).appendTo(tmp);
			Pablo.chevron({x: 13}).appendTo(tmp);
			Pablo.arrow({x: 27}).appendTo(tmp);
			Pablo.fletch({y: 60}).appendTo(tmp);

		</script>
  </body>
</html>
